<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tic-Tac-Toe Ultimate</title>
<style>
body {
    font-family: 'Segoe UI', Arial, sans-serif;
    text-align: center;
    background: linear-gradient(135deg, #ffecd2, #fcb69f);
    margin: 0;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
}
h1 { color: #ff6f61; margin-bottom: 5px; }
p { font-size: 18px; color: #333; margin-bottom: 10px; }
.board {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 8px;
    width: 90vw;
    max-width: 360px;
    margin-top: 20px;
}
.cell {
    position: relative;
    width: 100%;
    padding-top: 100%; /* square cells */
    background: white;
    border: 3px solid #ff6f61;
    border-radius: 15px;
    cursor: pointer;
    overflow: hidden;
    transition: transform 0.2s, background 0.3s;
    display: flex;
    justify-content: center;
    align-items: center;
}
.cell img {
    position: absolute;
    width: 80%;
    height: 80%;
    top: 10%;
    left: 10%;
    transition: transform 0.3s;
}
.cell.win {
    animation: winAnimation 0.8s ease infinite alternate;
}
@keyframes winAnimation {
    0% { background-color: gold; transform: scale(1); }
    50% { background-color: #ffd700; transform: scale(1.05); }
    100% { background-color: gold; transform: scale(1); }
}
#result { margin-top: 20px; font-size: 22px; font-weight: bold; color: #333; }
button { 
    margin-top: 20px; 
    padding: 15px 30px; 
    font-size: 18px; 
    cursor: pointer; 
    border-radius: 10px; 
    background:#ff6f61; 
    color:white; 
    border:none; 
    box-shadow: 0 4px #d45c52;
}
button:active { transform: translateY(2px); box-shadow: 0 2px #d45c52; }

#scoreboard { margin-top: 20px; font-size: 20px; color:#333; }
.confetti {
    position: fixed;
    width: 10px;
    height: 10px;
    background: gold;
    top: -10px;
    animation: fall 3s linear infinite;
    opacity: 0.8;
    border-radius: 50%;
}
@keyframes fall {
    0% { transform: translateY(0) rotate(0deg); }
    100% { transform: translateY(100vh) rotate(360deg); }
}
</style>
</head>
<body>

<h1>Tic-Tac-Toe Ultimate</h1>
<p>First to 5 wins is the champion!</p>

<div class="board" id="board">
    <div class="cell" onclick="makeMove(this,0)"></div>
    <div class="cell" onclick="makeMove(this,1)"></div>
    <div class="cell" onclick="makeMove(this,2)"></div>
    <div class="cell" onclick="makeMove(this,3)"></div>
    <div class="cell" onclick="makeMove(this,4)"></div>
    <div class="cell" onclick="makeMove(this,5)"></div>
    <div class="cell" onclick="makeMove(this,6)"></div>
    <div class="cell" onclick="makeMove(this,7)"></div>
    <div class="cell" onclick="makeMove(this,8)"></div>
</div>

<div id="result"></div>

<div id="scoreboard">
    <p>Player X Wins: <span id="xScore">0</span></p>
    <p>Player O Wins: <span id="oScore">0</span></p>
</div>

<button onclick="resetBoard()">Next Round</button>

<script>
// Assets
const xImg = "x.png";
const oImg = "o.png";
const placeSound = new Audio('place.mp3');
const winSound = new Audio('win.mp3');

let board = Array(9).fill('');
let currentPlayer = 'X';
let gameOver = false;
let xScore = 0;
let oScore = 0;
const roundsLimit = 5;

function makeMove(cell, index){
    if(board[index] === '' && !gameOver){
        board[index] = currentPlayer;

        let img = document.createElement('img');
        img.src = currentPlayer==='X'?xImg:oImg;
        cell.appendChild(img);

        // Animate placement
        img.style.transform = 'scale(0)';
        setTimeout(()=>{ img.style.transform='scale(1)'; }, 50);

        placeSound.play();
        checkWinner();

        if(!gameOver){
            currentPlayer = currentPlayer==='X'?'O':'X';
        }
    }
}

function checkWinner(){
    const winConditions = [
        [0,1,2],[3,4,5],[6,7,8],
        [0,3,6],[1,4,7],[2,5,8],
        [0,4,8],[2,4,6]
    ];

    for(const condition of winConditions){
        const [a,b,c] = condition;
        if(board[a] && board[a] === board[b] && board[a] === board[c]){
            document.getElementById('result').innerText = `Player ${board[a]} Wins!`;
            document.querySelectorAll('.cell').forEach((cell,index)=>{
                if(condition.includes(index)) cell.classList.add('win');
            });

            winSound.play();
            gameOver = true;

            if(board[a]==='X'){ 
                xScore++; 
                document.getElementById('xScore').innerText = xScore;
                if(xScore>=roundsLimit){ champion('X'); }
            }
            else { 
                oScore++; 
                document.getElementById('oScore').innerText = oScore;
                if(oScore>=roundsLimit){ champion('O'); }
            }
            return;
        }
    }

    if(!board.includes('') && !gameOver){
        document.getElementById('result').innerText = "It's a Tie!";
        gameOver = true;
    }
}

function resetBoard(){
    board = Array(9).fill('');
    gameOver = false;
    currentPlayer = 'X';
    document.getElementById('result').innerText = '';
    document.querySelectorAll('.cell').forEach(cell=>{
        cell.innerHTML = '';
        cell.classList.remove('win');
    });
}

function champion(player){
    alert(`Player ${player} is the Ultimate Champion!`);
    resetScores();
    confettiExplosion();
}

function resetScores(){
    xScore = 0; oScore = 0;
    document.getElementById('xScore').innerText = xScore;
    document.getElementById('oScore').innerText = oScore;
    resetBoard();
}

// Confetti animation
function confettiExplosion(){
    for(let i=0;i<50;i++){
        let confetti = document.createElement('div');
        confetti.classList.add('confetti');
        confetti.style.left = Math.random()*100+'vw';
        confetti.style.background = `hsl(${Math.random()*360}, 100%, 50%)`;
        confetti.style.animationDuration = (2+Math.random()*2)+'s';
        document.body.appendChild(confetti);
        setTimeout(()=>{ confetti.remove(); }, 3000);
    }
}
</script>

</body>
</html>